<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Supported callback functions:
&amp;#8216;request&amp;#8217;
This callback is called before an HTTP request
is performed, with the request object as an argument.
If the callback returns a value other than NULL, the HTTP
request is not performed at all, and the return value of the callback
is returned. This mechanism can be used to replay previously
recorded HTTP responses.

&amp;#8216;response&amp;#8217;
This callback is called after an HTTP request
is performed. The callback is called with two arguments: the
request object and the response object of the HTTP
request. If this callback returns a value other than NULL,
then this value is returned by httr.



"><title>Install or uninstall a callback function — get_callback • httr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><link href="../deps/_Source%20Sans%20Pro-0.4.1/font.css" rel="stylesheet"><link href="../deps/_Source%20Code%20Pro-0.4.1/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Install or uninstall a callback function — get_callback"><meta property="og:description" content="Supported callback functions:
&amp;#8216;request&amp;#8217;
This callback is called before an HTTP request
is performed, with the request object as an argument.
If the callback returns a value other than NULL, the HTTP
request is not performed at all, and the return value of the callback
is returned. This mechanism can be used to replay previously
recorded HTTP responses.

&amp;#8216;response&amp;#8217;
This callback is called after an HTTP request
is performed. The callback is called with two arguments: the
request object and the response object of the HTTP
request. If this callback returns a value other than NULL,
then this value is returned by httr.



"><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script defer data-domain="httr.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-none"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">httr</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.4.3.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/api-packages.html">Best practices for API packages</a>
    <a class="dropdown-item" href="../articles/quickstart.html">Getting started with httr</a>
    <a class="dropdown-item" href="../articles/secrets.html">Managing secrets</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-news">News</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-news">
    <h6 class="dropdown-header" data-toc-skip>Releases</h6>
    <a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2018/12/httr-1-4-0/">Version 1.4.0</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../news/index.html">Changelog</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/r-lib/httr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Install or uninstall a callback function</h1>
      <small class="dont-index">Source: <a href="https://github.com/r-lib/httr/blob/HEAD/R/callback.R" class="external-link"><code>R/callback.R</code></a></small>
      <div class="d-none name"><code>get_callback.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Supported callback functions:</p><dl><dt>‘request’</dt>
<dd><p>This callback is called before an HTTP request
is performed, with the <code>request</code> object as an argument.
If the callback returns a value other than <code>NULL</code>, the HTTP
request is not performed at all, and the return value of the callback
is returned. This mechanism can be used to replay previously
recorded HTTP responses.</p></dd>

<dt>‘response’</dt>
<dd><p>This callback is called after an HTTP request
is performed. The callback is called with two arguments: the
<code>request</code> object and the <code>response</code> object of the HTTP
request. If this callback returns a value other than <code>NULL</code>,
then this value is returned by <code>httr</code>.</p></dd>


</dl></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">get_callback</span><span class="op">(</span><span class="va">name</span><span class="op">)</span>

<span class="fu">set_callback</span><span class="op">(</span><span class="va">name</span>, new_callback <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>name</dt>
<dd><p>Character scalar, name of the callback to query or set.</p></dd>
<dt>new_callback</dt>
<dd><p>The callback function to install, a function object;
or <code>NULL</code> to remove the currently installed callback (if any).</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>get_callback</code> returns the currently installed
callback, or <code>NULL</code> if none is installed.
<code>set_callback</code> returns the previously installed callback,
or <code>NULL</code> if none was installed.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Note that it is not possible to install multiple callbacks of the same
type. The installed callback overwrites the previously intalled one.
To uninstall a callback function, set it to <code>NULL</code> with
<code>set_callback()</code>.</p>
<p>See the <code>httrmock</code> package for a proper example that uses
callbacks.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="co">## Log all HTTP requests to the screeen</span></span>
<span class="r-in"><span class="va">req_logger</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">req</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"HTTP request to"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sQuote.html" class="external-link">sQuote</a></span><span class="op">(</span><span class="va">req</span><span class="op">$</span><span class="va">url</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">old</span> <span class="op">&lt;-</span> <span class="fu">set_callback</span><span class="op">(</span><span class="st">"request"</span>, <span class="va">req_logger</span><span class="op">)</span></span>
<span class="r-in"><span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="GET.html">GET</a></span><span class="op">(</span><span class="st">"https://httpbin.org"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="GET.html">GET</a></span><span class="op">(</span><span class="st">"https://httpbin.org/ip"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">set_callback</span><span class="op">(</span><span class="st">"request"</span>, <span class="va">old</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Log all HTTP requests and response status codes as well</span></span>
<span class="r-in"><span class="va">req_logger2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">req</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"HTTP request to"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sQuote.html" class="external-link">sQuote</a></span><span class="op">(</span><span class="va">req</span><span class="op">$</span><span class="va">url</span><span class="op">)</span>, <span class="st">"... "</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"><span class="va">res_logger</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">req</span>, <span class="va">res</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">status_code</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">old_req</span> <span class="op">&lt;-</span> <span class="fu">set_callback</span><span class="op">(</span><span class="st">"request"</span>, <span class="va">req_logger2</span><span class="op">)</span></span>
<span class="r-in"><span class="va">old_res</span> <span class="op">&lt;-</span> <span class="fu">set_callback</span><span class="op">(</span><span class="st">"response"</span>, <span class="va">res_logger</span><span class="op">)</span></span>
<span class="r-in"><span class="va">g3</span> <span class="op">&lt;-</span> <span class="fu"><a href="GET.html">GET</a></span><span class="op">(</span><span class="st">"https://httpbin.org"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">g4</span> <span class="op">&lt;-</span> <span class="fu"><a href="GET.html">GET</a></span><span class="op">(</span><span class="st">"https://httpbin.org/ip"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">set_callback</span><span class="op">(</span><span class="st">"request"</span>, <span class="va">old_req</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">set_callback</span><span class="op">(</span><span class="st">"response"</span>, <span class="va">old_res</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Return a recorded response, without performing the HTTP request</span></span>
<span class="r-in"><span class="va">replay</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">req</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">  <span class="kw">if</span> <span class="op">(</span><span class="va">req</span><span class="op">$</span><span class="va">url</span> <span class="op">==</span> <span class="st">"https://httpbin.org"</span><span class="op">)</span> <span class="va">g3</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"><span class="va">old_req</span> <span class="op">&lt;-</span> <span class="fu">set_callback</span><span class="op">(</span><span class="st">"request"</span>, <span class="va">replay</span><span class="op">)</span></span>
<span class="r-in"><span class="va">grec</span> <span class="op">&lt;-</span> <span class="fu"><a href="GET.html">GET</a></span><span class="op">(</span><span class="st">"https://httpbin.org"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">grec</span><span class="op">$</span><span class="va">date</span> <span class="op">==</span> <span class="va">g3</span><span class="op">$</span><span class="va">date</span></span>
<span class="r-in"><span class="fu">set_callback</span><span class="op">(</span><span class="st">"request"</span>, <span class="va">old_req</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="http://hadley.nz" class="external-link">Hadley Wickham</a>, <a href="https://www.rstudio.com" class="external-link"><img src="https://www.tidyverse.org/rstudio-logo.svg" alt="RStudio" width="72"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

  </div></footer></body></html>

